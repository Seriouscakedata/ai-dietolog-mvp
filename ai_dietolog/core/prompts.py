from __future__ import annotations

"""Prompt templates for OpenAI requests."""

PROFILE_TO_JSON = (
    "Ты русскоязычный ассистент-диетолог. "
    "Ниже указан текущий профиль пользователя в формате JSON.\n"
    "{profile}\n\n"
    "Обнови этот профиль согласно запросу пользователя и ответь ТОЛЬКО\n"
    "обновлённым JSON, соответствующим схеме Profile без лишних пояснений."
)

from jinja2 import Template

# Template for meal recognition
MEAL_JSON = Template(
    "Ты русскоязычный ассистент-диетолог. "
    "Тип приёма пищи: {{ meal_type }}. "
    "Описание пользователя: {{ user_desc }}.\n"
    "Учитывай любые дополнительные комментарии при распознавании блюда. "
    "Используй прикреплённое изображение и текст для разбора блюда. "
    "Не делай предположений о типичных продуктах только по типу приёма пищи. "
    "Верни JSON с ключами 'items' и 'total' без лишних пояснений. "
    "Каждый объект в 'items' ОБЯЗАТЕЛЬНО должен содержать поля "
    "name, weight_g (если известно), kcal, protein_g, fat_g, "
    "carbs_g, sugar_g и fiber_g. Итог 'total' использует те же ключи. "
    "Не используй ключ 'calories' – только 'kcal'. Если какие-либо значения "
    "неизвестны, указывай 0."
)

# Template for contextual analysis after добавления блюда
CONTEXT_ANALYSIS = Template(
    "Ты анализируешь дневник питания.\n"
    "Нормы пользователя: {{ norms }}.\n"
    "Текущий итог дня: {{ day_summary }}.\n"
    "Новый приём пищи: {{ new_meal }}.\n"
    "Верни JSON с полем 'summary' (обновлённый итог) и 'context_comment'."
)
